(this["webpackJsonpbloglist-fronted"]=this["webpackJsonpbloglist-fronted"]||[]).push([[0],{40:function(e,t,n){e.exports=n(70)},68:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),u=n.n(c),l=n(15),o=n(3),i=n(37),s=n(38),m=n(11),f=function(e){return{type:"SET_USER",data:e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;case"LOG_OUT":return null;default:return e}},p=function(e){return{type:"REMOVE_BLOG",data:e}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},v=n(1),E=n.n(v),g=n(5),h=function(e){return{type:"SUCCESS_ALERT",data:e}},O=function(e){return{type:"ERROR_ALERT",data:e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SUCCESS_ALERT":return{state:!0,text:t.data};case"ERROR_ALERT":return{state:!1,text:t.data};case"REMOVE_ALERT":return null;default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},w=(n(50),n(4)),k=n(13),S=n.n(k),x="/api/blogs",N=null,R=function(){var e=Object(g.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get(x);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(g.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:N}},e.next=3,S.a.post("".concat(x,"/").concat(t,"/comments"),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T={getAll:R,create:function(){var e=Object(g.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,S.a.post(x,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){N="bearer ".concat(e)},updateLikes:function(){var e=Object(g.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,S.a.put("".concat(x,"/").concat(t.id),t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(g.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,S.a.delete("".concat(x,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:C},_=(n(68),n(8)),L={login:function(){var e=Object(g.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},A=function(){var e=Object(a.useState)(""),t=Object(_.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),l=Object(_.a)(u,2),i=l[0],s=l[1],m=Object(o.b)(),d=function(){var e=Object(g.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,L.login({name:n,password:i,username:n});case 4:(a=e.sent)&&(window.localStorage.setItem("loggedBlogUser",JSON.stringify(a)),T.setToken(a.token),m(f(a)),m(h("Logged successfully"))),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),m(O("Invalid username or password")),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null," log in to application"),r.a.createElement("form",{onSubmit:d},r.a.createElement("div",null,"username ",r.a.createElement("input",{onChange:function(e){var t=e.target;c(t.value)},id:"input-username"})),r.a.createElement("div",null,"password ",r.a.createElement("input",{type:"password",onChange:function(e){var t=e.target;s(t.value)},id:"input-password"})),r.a.createElement("button",{type:"submit"},"login")))},I=n(14),U=function(){var e,t,n,c=Object(a.useState)(null),u=Object(_.a)(c,2),l=u[0],i=u[1],s=Object(o.c)((function(e){return e.blogs})),m=Object(o.b)(),f=function(){var e=Object(g.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),l&&l.title&&l.author&&l.url){e.next=4;break}return m(O("Missing blog's atributes")),e.abrupt("return");case 4:return e.next=6,T.create(l);case 6:(n=e.sent)&&(m({type:"ADD_BLOG",data:s.concat(n)}),m(h("".concat(JSON.stringify(l.title)," created successfully")))),i(null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"box"},r.a.createElement("h3",null,"create new"),r.a.createElement("form",{onSubmit:f},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"title"}),r.a.createElement("input",{className:"textarea is-small",value:null!==(e=null===l||void 0===l?void 0:l.title)&&void 0!==e?e:"",onChange:function(e){var t=e.target;i(Object(I.a)(Object(I.a)({},l),{},{title:t.value}))},placeholder:"Write the best blog ever"})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"author"}),r.a.createElement("input",{value:null!==(t=null===l||void 0===l?void 0:l.author)&&void 0!==t?t:"",onChange:function(e){var t=e.target;i(Object(I.a)(Object(I.a)({},l),{},{author:t.value}))},className:"author",placeholder:"Who is the author of this blog?"})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"url"}),r.a.createElement("input",{value:null!==(n=null===l||void 0===l?void 0:l.url)&&void 0!==n?n:"",onChange:function(e){var t=e.target;i(Object(I.a)(Object(I.a)({},l),{},{url:t.value}))},className:"url",placeholder:"e.g www.hanielbaez.com"})),r.a.createElement("button",{type:"submit",id:"submit-button"},"create")))},B=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(_.a)(n,2),u=c[0],l=c[1],o={display:u?"none":""},i={display:u?"":"none"},s=function(){l(!u)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:o},r.a.createElement("button",{type:"button",onClick:s},e.buttonTitle)),r.a.createElement("div",{style:i,className:"togglableContent"},e.children,r.a.createElement("button",{type:"button",onClick:s},"Cancel")))})),D=function(){var e=Object(o.c)((function(e){return e.blogs}));return r.a.createElement("div",{className:"box"},e.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(m.b,{to:"/blogs/".concat(e.id)},e.title))})))},F=n(39),G=function(e){var t=e.createComment,n=Object(a.useState)(""),c=Object(_.a)(n,2),u=c[0],l=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("input",{value:u,onChange:function(e){l(e.target.value)}}),r.a.createElement("button",{onClick:function(e){return e.preventDefault(),void t(u).then((function(e){l("")}))}},"add comment")))},M=function(e){var t=Object(a.useState)([]),n=Object(_.a)(t,2),c=n[0],u=n[1],l=Object(w.f)("/blogs/:id");Object(a.useEffect)((function(){e.comments&&u(e.comments)}),[]);var o=function(){var e=Object(g.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.addComment(l.params.id,[].concat(Object(F.a)(c),[t]));case 2:return n=e.sent,u(n.comments),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"comments"),r.a.createElement(G,{createComment:o}),c&&r.a.createElement("ul",null,c.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},J=function(e){var t,n=e.blogSelected,c=Object(a.useState)(n),u=Object(_.a)(c,2),l=u[0],i=u[1],s=Object(o.b)();if(!l)return null;var m=JSON.parse(localStorage.getItem("loggedBlogUser")),f=function(){var e=Object(g.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=Object(I.a)(Object(I.a)({},l),{},{likes:l.likes+1}),e.next=4,T.updateLikes(n);case 4:i(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(g.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!window.confirm("Remove blog ".concat(l.title," by ").concat(l.author))){e.next=6;break}return e.next=5,T.remove(l.id);case 5:s(p(l));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=r.a.createElement("div",null,r.a.createElement("button",{id:"remove-button",type:"button",onClick:d},"remove"));return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"box"},r.a.createElement("h2",null,l.title),r.a.createElement("a",{href:l.url},l.url),r.a.createElement("p",null,"likes ",l.likes,r.a.createElement("button",{id:"like-button",type:"button",onClick:f},"like")),r.a.createElement("p",null,"added by ",l.author),(null===m||void 0===m?void 0:m.username)===(null===l||void 0===l||null===(t=l.user)||void 0===t?void 0:t.username)&&b,r.a.createElement(M,{comments:l.comments})))},z=function(){var e=Object(o.c)((function(e){return e.alert}));return e&&r.a.createElement("div",{className:"notification ".concat(e.state?"is-success":"is-warning")},e.text)},V={getAll:function(){var e=Object(g.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},W=function(){var e=Object(o.c)((function(e){return e.users})),t=Object(o.b)();return Object(a.useEffect)((function(){V.getAll().then((function(e){t(function(e){return{type:"INIT_USERS",data:e}}(e))}))}),[t]),r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,r.a.createElement("b",null,"blogs created"))),e.map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,r.a.createElement(m.b,{to:"/users/".concat(e.id)},e.name,"  ")),r.a.createElement("td",null,e.blogs.length))})))))},H=function(){var e=Object(o.c)((function(e){return e.users})),t=Object(w.f)("/users/:id"),n=e.find((function(e){return e.id===t.params.id}));return n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,n.name),r.a.createElement("h3",null,"added blogs"),r.a.createElement("ul",null,n.blogs.map((function(e){return r.a.createElement("li",{key:e.title+Math.random().toString},e.title)}))))},q=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.b)();return r.a.createElement(r.a.Fragment,null,null===e||void 0===e?void 0:e.username," logged in",r.a.createElement("button",{id:"logout-button",onClick:function(){window.localStorage.removeItem("loggedBlogUser"),t({type:"LOG_OUT"}),t(h("logout sueccessfully")),t(function(){var e=Object(g.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){t({type:"REMOVE_ALERT"})}),5e3);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},"logout"))},K={padding:5},P=function(){return r.a.createElement("header",null,r.a.createElement("nav",{className:"navbar"},r.a.createElement(m.b,{style:K,to:"/"},"home"),r.a.createElement(m.b,{style:K,to:"/users"},"users"),r.a.createElement(q,null)))},Q=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.c)((function(e){return e.blogs})),n=Object(o.b)(),c=Object(a.useRef)();Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogUser");if(e){var t=JSON.parse(e);n(f(t)),T.setToken(t.token)}}),[n]),Object(a.useEffect)((function(){T.getAll().then((function(e){e.sort((function(e,t){return t.likes-e.likes})),n(function(e){return{type:"INIT_BLOGS",data:e}}(e))}))}),[n]);var u=Object(w.f)("/blogs/:id"),l=u?t.find((function(e){return e.id===u.params.id})):null;return console.log(),r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement(P,null),r.a.createElement(z,null),null!==e?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"blogs"),r.a.createElement(w.c,null,r.a.createElement(w.a,{path:"/blogs/:id"},r.a.createElement(J,{blogSelected:l})),r.a.createElement(w.a,{path:"/users/:id"},r.a.createElement(H,null)),r.a.createElement(w.a,{path:"/users"},r.a.createElement(W,null)),r.a.createElement(w.a,{path:"/"},r.a.createElement(B,{buttonTitle:"new note",ref:c},r.a.createElement(U,null)),r.a.createElement(D,null)))):r.a.createElement(A,null)))},X=Object(l.combineReducers)({user:d,blogs:b,alert:j,users:y}),Y=Object(l.createStore)(X,Object(s.composeWithDevTools)(Object(l.applyMiddleware)(i.a)));u.a.render(r.a.createElement(o.a,{store:Y},r.a.createElement(m.a,null,r.a.createElement(Q,null))),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.d06ccf78.chunk.js.map